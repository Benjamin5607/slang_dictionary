<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Slang AI</title>
    <style>
        :root { --primary: #6366f1; --bg: #f3f4f6; --text: #1f2937; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); color: var(--text); padding: 20px; margin: 0; }
        .container { max-width: 600px; margin: 0 auto; }

        /* ìƒë‹¨ ì–¸ì–´ ì„¤ì • ë°” */
        .top-bar { display: flex; justify-content: flex-end; margin-bottom: 20px; }
        .lang-select { padding: 8px 12px; border-radius: 20px; border: 1px solid #cbd5e1; background: white; font-size: 0.85rem; cursor: pointer; }

        h1 { text-align: center; margin: 0; font-size: 2rem; color: #111; }
        .subtitle { text-align: center; color: #6b7280; margin-bottom: 30px; font-size: 0.9em; }

        /* ì»¨íŠ¸ë¡¤ íŒ¨ë„ */
        .control-panel { background: white; padding: 20px; border-radius: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        
        .input-group { margin-bottom: 15px; }
        label { display: block; font-size: 0.8rem; font-weight: 700; color: #6b7280; margin-bottom: 5px; text-transform: uppercase; }
        
        select, input { width: 100%; padding: 12px; border: 1px solid #e5e7eb; border-radius: 10px; font-size: 16px; box-sizing: border-box; background: #fff; }
        select { appearance: none; background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e"); background-repeat: no-repeat; background-position: right 1rem center; background-size: 1em; }
        
        button { width: 100%; padding: 14px; background: var(--primary); color: white; border: none; border-radius: 10px; font-weight: bold; font-size: 16px; cursor: pointer; transition: 0.2s; }
        button:disabled { background: #cbd5e1; cursor: not-allowed; }

        /* ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ */
        .loading { text-align: center; margin-top: 40px; display: none; }
        .spinner { font-size: 2.5rem; animation: spin 1s infinite linear; display: inline-block; }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        /* AI ê²°ê³¼ ì¹´ë“œ */
        .ai-card { background: white; border-radius: 20px; padding: 25px; margin-top: 20px; box-shadow: 0 10px 20px rgba(0,0,0,0.1); border-top: 5px solid var(--primary); display: none; }
        
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .word-title { font-size: 1.8rem; font-weight: 800; color: #111; }
        .badge { background: #e0e7ff; color: var(--primary); padding: 5px 10px; border-radius: 8px; font-size: 0.75rem; font-weight: bold; }

        .section-title { font-size: 0.75rem; font-weight: 800; color: #9ca3af; text-transform: uppercase; margin-top: 20px; margin-bottom: 8px; letter-spacing: 0.05em; }
        .content-text { font-size: 1.1rem; line-height: 1.6; color: #374151; }
        .example-box { background: #f9fafb; border-left: 4px solid var(--primary); padding: 15px; border-radius: 0 8px 8px 0; font-style: italic; color: #4b5563; }
    </style>
</head>
<body>

<div class="container">
    <div class="top-bar">
        <select id="uiLang" class="lang-select" onchange="changeUILanguage()">
            <option value="EN">ğŸŒ English</option>
            <option value="KR">ğŸ‡°ğŸ‡· í•œêµ­ì–´</option>
            <option value="JP">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
            <option value="ES">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
        </select>
    </div>

    <h1 id="appTitle">Global Slang AI</h1>
    <div class="subtitle" id="appSubtitle">Powered by Groq Intelligence</div>

    <div class="control-panel">
        <div class="input-group">
            <label id="lblTargetCountry">Target Country</label>
            <select id="countrySelect">
                </select>
        </div>

        <div class="input-group">
            <label id="lblSearch">Slang Term</label>
            <input type="text" id="searchInput" placeholder="e.g. Rizz" onkeypress="if(event.key==='Enter') askAI()">
        </div>

        <button onclick="askAI()" id="searchBtn">Analyze</button>
    </div>

    <div id="loader" class="loading">
        <div class="spinner">ğŸ§ </div>
        <p id="loadingText">AI is thinking...</p>
    </div>

    <div id="resultCard" class="ai-card">
        <div class="card-header">
            <span class="word-title" id="r_word"></span>
            <span class="badge">AI CURATED</span>
        </div>

        <div class="section-title" id="lblDef">Definition</div>
        <div class="content-text" id="r_def"></div>

        <div class="section-title" id="lblOrigin">Origin & Nuance</div>
        <div class="content-text" id="r_origin"></div>

        <div class="section-title" id="lblEx">Example</div>
        <div class="example-box" id="r_ex"></div>
    </div>
</div>

<script>
    // --- 1. ë°ì´í„° ì„¤ì • (ë²ˆì—­ + êµ­ê°€) ---
    const i18n = {
        EN: { title: "Global Slang AI", subtitle: "Powered by Groq Intelligence", lblCountry: "Target Country", lblSearch: "Slang Term", btnSearch: "Analyze", loading: "AI is thinking... ğŸ§ ", lblDef: "Definition", lblOrigin: "Origin & Nuance", lblEx: "Example" },
        KR: { title: "ê¸€ë¡œë²Œ ìŠ¬ë­ AI", subtitle: "Groq ì¸ê³µì§€ëŠ¥ ê¸°ë°˜ ë¶„ì„", lblCountry: "ê²€ìƒ‰í•  êµ­ê°€", lblSearch: "ìŠ¬ë­ ë‹¨ì–´", btnSearch: "ë¶„ì„í•˜ê¸°", loading: "AIê°€ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤... ğŸ§ ", lblDef: "ëœ» (ì˜ë¯¸)", lblOrigin: "ìœ ë˜ ë° ë‰˜ì•™ìŠ¤", lblEx: "ì‚¬ìš© ì˜ˆì‹œ" },
        JP: { title: "ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ»ã‚¹ãƒ©ãƒ³ã‚°AI", subtitle: "Groq AIã«ã‚ˆã‚‹åˆ†æ", lblCountry: "å¯¾è±¡å›½", lblSearch: "ã‚¹ãƒ©ãƒ³ã‚°å˜èª", btnSearch: "åˆ†æã™ã‚‹", loading: "AIãŒè€ƒãˆä¸­... ğŸ§ ", lblDef: "æ„å‘³", lblOrigin: "ç”±æ¥ãƒ»ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹", lblEx: "ä½¿ç”¨ä¾‹" },
        ES: { title: "Argot Global AI", subtitle: "Impulsado por Groq", lblCountry: "PaÃ­s de destino", lblSearch: "TÃ©rmino", btnSearch: "Analizar", loading: "IA pensando... ğŸ§ ", lblDef: "DefiniciÃ³n", lblOrigin: "Origen y Matiz", lblEx: "Ejemplo" }
    };

    const countryData = {
        "Asia": [
            { code: "KR", name: "ğŸ‡°ğŸ‡· South Korea" }, { code: "JP", name: "ğŸ‡¯ğŸ‡µ Japan" },
            { code: "CN", name: "ğŸ‡¨ğŸ‡³ China" }, { code: "VN", name: "ğŸ‡»ğŸ‡³ Vietnam" },
            { code: "TH", name: "ğŸ‡¹ğŸ‡­ Thailand" }, { code: "ID", name: "ğŸ‡®ğŸ‡© Indonesia" },
            { code: "IN", name: "ğŸ‡®ğŸ‡³ India" }
        ],
        "North America": [
            { code: "US", name: "ğŸ‡ºğŸ‡¸ United States" }, { code: "CA", name: "ğŸ‡¨- Canada" },
            { code: "MX", name: "ğŸ‡²ğŸ‡½ Mexico" }
        ],
        "Europe": [
            { code: "GB", name: "ğŸ‡¬ğŸ‡§ United Kingdom" }, { code: "FR", name: "ğŸ‡«ğŸ‡· France" },
            { code: "DE", name: "ğŸ‡©ğŸ‡ª Germany" }, { code: "ES", name: "ğŸ‡ªğŸ‡¸ Spain" },
            { code: "IT", name: "ğŸ‡®ğŸ‡¹ Italy" }, { code: "RU", name: "ğŸ‡·ğŸ‡º Russia" }
        ],
        "South America": [
            { code: "BR", name: "ğŸ‡§ğŸ‡· Brazil" }, { code: "AR", name: "ğŸ‡¦ğŸ‡· Argentina" }
        ],
        "Others": [
            { code: "AU", name: "ğŸ‡¦ğŸ‡º Australia" }, { code: "ZA", name: "ğŸ‡¿ğŸ‡¦ South Africa" }
        ]
    };

    // --- 2. ì´ˆê¸°í™” ---
    window.onload = function() {
        // êµ­ê°€ ë¦¬ìŠ¤íŠ¸ ì±„ìš°ê¸°
        const select = document.getElementById('countrySelect');
        let html = '';
        for (const [region, countries] of Object.entries(countryData)) {
            html += `<optgroup label="${region}">`;
            countries.forEach(c => html += `<option value="${c.code}">${c.name}</option>`);
            html += `</optgroup>`;
        }
        select.innerHTML = html;
        
        // ì–¸ì–´ ì„¤ì • ì ìš©
        changeUILanguage();
    };

    // --- 3. ì–¸ì–´ ë³€ê²½ ë¡œì§ ---
    function changeUILanguage() {
        const lang = document.getElementById('uiLang').value;
        const text = i18n[lang];

        document.getElementById('appTitle').innerText = text.title;
        document.getElementById('appSubtitle').innerText = text.subtitle;
        document.getElementById('lblTargetCountry').innerText = text.lblCountry;
        document.getElementById('lblSearch').innerText = text.lblSearch;
        document.getElementById('searchBtn').innerText = text.btnSearch;
        document.getElementById('loadingText').innerText = text.loading;
        
        // ê²°ê³¼ ì¹´ë“œ ë¼ë²¨ ë³€ê²½
        document.getElementById('lblDef').innerText = text.lblDef;
        document.getElementById('lblOrigin').innerText = text.lblOrigin;
        document.getElementById('lblEx').innerText = text.lblEx;
    }

    // --- 4. AI í˜¸ì¶œ ë¡œì§ ---
    async function askAI() {
        const term = document.getElementById('searchInput').value;
        const country = document.getElementById('countrySelect').value;
        const btn = document.getElementById('searchBtn');
        const loader = document.getElementById('loader');
        const card = document.getElementById('resultCard');

        if (!term) return alert("Please enter a term!");

        // UI ìƒíƒœ ë³€ê²½
        card.style.display = 'none';
        loader.style.display = 'block';
        btn.disabled = true;

        try {
            // ì„œë²„ í˜¸ì¶œ (404 ì—ëŸ¬ë‚˜ë©´ ì„œë²„ ì¬ì‹œì‘ í•„ìˆ˜!)
            const res = await fetch(`/curate?term=${encodeURIComponent(term)}&country=${country}`);
            
            if (!res.ok) throw new Error("Server Error (404 or 500)");
            
            const json = await res.json();

            if (json.status === 'ok') {
                const data = json.data;
                document.getElementById('r_word').innerText = term;
                document.getElementById('r_def').innerText = data.definition;
                document.getElementById('r_origin').innerText = data.origin;
                document.getElementById('r_ex').innerText = `"${data.example}"`;
                
                loader.style.display = 'none';
                card.style.display = 'block';
            } else {
                throw new Error(json.msg || "Analysis failed");
            }

        } catch (e) {
            console.error(e);
            alert("Error: ì„œë²„ê°€ ì¼œì ¸ ìˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”! (Codespaces í„°ë¯¸ë„ì—ì„œ 'python app.py' ì¬ì‹œì‘)");
            loader.style.display = 'none';
        } finally {
            btn.disabled = false;
        }
    }
</script>

</body>
</html>
